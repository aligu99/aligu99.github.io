"use strict";function setMask(){return null!=document.getElementsByClassName("rmMask")[0]?document.getElementsByClassName("rmMask")[0]:((mask=document.createElement("div")).className="rmMask",mask.style.width=window.innerWidth+"px",mask.style.height=window.innerHeight+"px",mask.style.background="#fff",mask.style.opacity=".0",mask.style.position="fixed",mask.style.top="0",mask.style.left="0",mask.style.zIndex=998,document.body.appendChild(mask),document.getElementById("rightmenu").style.zIndex=19198,mask)}function insertAtCursor(e,t){var n,o,i;document.selection?(e.focus(),(sel=document.selection.createRange()).text=t,sel.select()):e.selectionStart||"0"==e.selectionStart?(n=e.selectionStart,o=e.selectionEnd,i=e.scrollTop,e.value=e.value.substring(0,n)+t+e.value.substring(o,e.value.length),0<i&&(e.scrollTop=i),e.focus(),e.selectionStart=n+t.length,e.selectionEnd=n+t.length):(e.value+=t,e.focus())}var rmf={};function popupMenu(){window.oncontextmenu=function(e){if("off"==mouseMode)return!0;$(".rightmenu-group.hide").hide(),document.getSelection().toString()&&$("#menu-text").show(),(document.getElementById("post")||document.getElementById("page"))&&$("#menu-post").show();var o=window.document.body,o=e.target,t=(/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\*\+,;=.]+$/.test(window.getSelection().toString())&&"A"!=o.tagName&&$("#menu-too").show(),"A"==o.tagName?($("#menu-to").show(),rmf.open=function(){-1==o.href.indexOf("http://")&&-1==o.href.indexOf("https://")||-1!=o.href.indexOf("yisous.xyz")?pjax.loadUrl(o.href):location.href=o.href},rmf.openWithNewTab=function(){window.open(o.href)},rmf.copyLink=function(){var e=o.href,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)}):"IMG"==o.tagName?($("#menu-img").show(),rmf.openWithNewTab=function(){window.open(o.src)},rmf.click=function(){o.click()},rmf.copyLink=function(){var e=o.src,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)},rmf.saveAs=function(){var e=document.createElement("a"),t=o.src,n=t.split("/")[-1];e.href=t,e.download=n,e.click(),window.URL.revokeObjectURL(t)}):"TEXTAREA"!=o.tagName&&"INPUT"!=o.tagName||($("#menu-paste").show(),rmf.paste=function(){navigator.permissions.query({name:"clipboard-read"}).then(function(e){"granted"==e.state||"prompt"==e.state?navigator.clipboard.readText().then(function(e){console.log(e),insertAtCursor(o,e)}):Snackbar.show({text:"请允许读取剪贴板！",pos:"top-center",showAction:!1})})}),e.clientX+10),e=e.clientY,n=$("#rightmenu").width(),i=$("#rightmenu").height();return t+n>window.innerWidth&&(t-=n+10),e+i>window.innerHeight&&(e-=e+i-window.innerHeight),mask=setMask(),$(".rightmenu-item").click(function(){$(".rmMask").attr("style","display: none")}),$(window).resize(function(){rmf.showrightmenu(!1),$(".rmMask").attr("style","display: none")}),mask.onclick=function(){$(".rmMask").attr("style","display: none")},rmf.showrightmenu(!0,e,t),$(".rmMask").attr("style","display: flex"),!1},window.addEventListener("click",function(){rmf.showrightmenu(!1)})}rmf.showrightmenu=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=$("#rightmenu");o.css("top",t+"px").css("left",n+"px"),e?o.show():o.hide()},rmf.copyWordsLink=function(){var e=window.location.href,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)},rmf.switchReadMode=function(){var t=document.body,n=(t.classList.add("read-mode"),document.createElement("button"));n.type="button",n.className="fas fa-sign-out-alt exit-readmode",t.appendChild(n),n.addEventListener("click",function e(){t.classList.remove("read-mode"),n.remove(),n.removeEventListener("click",e)})},rmf.copySelect=function(){document.execCommand("Copy",!1,null)},rmf.scrollToTop=function(){btf.scrollToDest(0,500)},document.body.addEventListener("touchmove",function(){},{passive:!1}),navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)||popupMenu();var box=document.documentElement;function addLongtabListener(e,t){var n=0;e.ontouchstart=function(){n=0,n=setTimeout(function(){t(),n=0},380)},e.ontouchmove=function(){clearTimeout(n),n=0},e.ontouchend=function(){n&&clearTimeout(n)}}addLongtabListener(box,popupMenu),rmf.fullScreen=function(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()},null==localStorage.getItem("mouse")&&localStorage.setItem("mouse","on");var mouseMode=localStorage.getItem("mouse");function changeMouseMode(){"on"==localStorage.getItem("mouse")?(mouseMode="off",localStorage.setItem("mouse","off")):(mouseMode="on",localStorage.setItem("mouse","on"))}